create table administradores
(
    id bigint not null,
    primary key (id)
);
create table administradores_reportes_activos
(
    administrador_id    bigint not null,
    reportes_activos_id bigint not null unique
);
create table articulos
(
    id             bigint generated by default as identity,
    intercambio_id bigint,
    usuario_id     bigint,
    categoria      varchar(255) not null check (categoria in ('ROPA', 'LIBROS', 'UTILES', 'ACCESORIOS')),
    descripcion    varchar(255) not null,
    estado         varchar(255) not null check (estado in ('DISPONIBLE', 'EN_NEGOCIACION', 'INTERCAMBIADO')),
    nombre         varchar(255) not null,
    ruta_imagen    varchar(255),
    primary key (id)
);
create table intercambios
(
    id             bigint generated by default as identity,
    usuario_dos_id bigint       not null,
    usuario_uno_id bigint       not null,
    estado         varchar(255) not null check (estado in ('SOLICITADO', 'ACEPTADO', 'REALIZADO', 'CANCELADO')),
    primary key (id)
);
create table personas
(
    id       bigint generated by default as identity,
    apellido varchar(100) not null,
    nombre   varchar(100) not null,
    correo   varchar(150),
    password varchar(255) not null,
    primary key (id)
);
create table reportes
(
    id          bigint generated by default as identity,
    usuario_id  bigint unique,
    descripcion varchar(255) not null,
    estado      varchar(255) not null check (estado in ('ACTIVO', 'EN_REVISION', 'REVISADO', 'CANCELADO')),
    primary key (id)
);
create table resenhas
(
    puntuacion     float(53) check ((puntuacion <= 5) and (puntuacion >= 1)),
    autor_id       bigint unique,
    id             bigint generated by default as identity,
    intercambio_id bigint       not null,
    descripcion    varchar(255) not null,
    primary key (id)
);
create table usuarios
(
    id bigint not null,
    primary key (id)
);
alter table if exists administradores
    add constraint FKl4otp2sbfl5pyon07k8mmxyta
        foreign key (id)
            references personas;

alter table if exists administradores_reportes_activos
    add constraint FKd70jov0hncme8tirqqdosa9mr
        foreign key (reportes_activos_id)
            references reportes;
alter table if exists administradores_reportes_activos
    add constraint FKedpuu6incbfoucq2qefikfohh
        foreign key (administrador_id)
            references administradores;
alter table if exists articulos
    add constraint FK455wojdga9w7vhq3c0xogo0x0
        foreign key (intercambio_id)
            references intercambios;
alter table if exists articulos
    add constraint FKswt7sbiu8qcbmvp2nm9plrltk
        foreign key (usuario_id)
            references usuarios;
alter table if exists intercambios
    add constraint FK9y3f02f62mi2evcxxf42ybrmx
        foreign key (usuario_dos_id)
            references usuarios;
alter table if exists intercambios
    add constraint FKddajts9alqf327dt92m4d4g9v
        foreign key (usuario_uno_id)
            references usuarios;
alter table if exists reportes
    add constraint FKjb16uevkap6vb4wd2kimdomuc
        foreign key (usuario_id)
            references usuarios;
alter table if exists resenhas
    add constraint FKt1nphu4d38s7beyr49v4mrelr
        foreign key (autor_id)
            references usuarios;
alter table if exists resenhas
    add constraint FKlcm9xfskom5xfn7fklvmo4vfy
        foreign key (intercambio_id)
            references intercambios;
alter table if exists usuarios
    add constraint FKjdiqy1h3s5meigcqmjdcpt1ko
        foreign key (id)
            references personas